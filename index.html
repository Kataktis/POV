<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KATAKTIS POV Manager</title>
  <script src="https://player.twitch.tv/js/embed/v1.js"></script>
  <style>
    body {
      margin: 0;
      font-family: "Rajdhani", sans-serif;
      background-color: #0d0d0d;
      color: #fff;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #1a0000;
      padding: 10px 20px;
      border-bottom: 3px solid #ff0000;
    }

    header img.logo {
      height: 40px;
    }

    .player-selection {
      display: flex;
      gap: 15px;
      align-items: center;
      flex-wrap: wrap;
    }

    .player-selection label {
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      padding: 5px 10px;
      background: #2a0000;
      border-radius: 6px;
      border: 1px solid #ff0000;
      transition: 0.3s;
    }

    .player-selection label:hover {
      background: #400000;
    }

    .player-selection img {
      height: 16px;
      width: auto;
      border-radius: 2px;
    }

    .pov-container {
      display: grid;
      gap: 10px;
      width: 100%;
      height: 100%;
      padding: 10px;
      transition: all 0.3s ease;
      background: #0d0d0d;
    }

    .pov-container[data-count="1"] {
      grid-template-columns: 1fr;
      grid-template-rows: 1fr;
    }

    .pov-container[data-count="2"] {
      grid-template-columns: 1fr 1fr;
    }

    .pov-container[data-count="3"] {
      grid-template-columns: repeat(3, 1fr);
    }

    .pov-container[data-count="4"],
    .pov-container[data-count="5"] {
      grid-template-columns: repeat(2, 1fr);
      grid-template-rows: repeat(2, 1fr);
    }

    .pov-container[data-count="6"],
    .pov-container[data-count="7"],
    .pov-container[data-count="8"] {
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      grid-template-rows: repeat(auto-fit, minmax(200px, 1fr));
    }

    .pov {
      position: relative;
      border-radius: 10px;
      overflow: hidden;
      background: #000;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      transition: 0.3s;
      border: 2px solid #ff0000;
    }

    .info-bar {
      position: absolute;
      top: 5px;
      left: 5px;
      display: flex;
      align-items: center;
      background: rgba(0, 0, 0, 0.6);
      padding: 3px 8px;
      border-radius: 5px;
      gap: 5px;
      font-size: 14px;
    }

    .info-bar img {
      height: 16px;
      border-radius: 2px;
    }

    .focus-btn {
      position: absolute;
      top: 5px;
      right: 5px;
      background: #ff0000;
      border: none;
      color: white;
      border-radius: 5px;
      padding: 4px 6px;
      cursor: pointer;
      transition: 0.2s;
      font-weight: bold;
    }

    .focus-btn:hover {
      background: #ff3333;
    }

    .focus {
      grid-column: 1 / -1 !important;
      grid-row: 1 / -1 !important;
      z-index: 2;
      transform: scale(1.02);
      border-color: #ffffff;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>
  <header>
    <img src="logo.png" alt="Team Logo" class="logo" />
    <div class="player-selection">
      <label><input type="checkbox" data-player="erxk" checked><img src="hu.png" alt="">Erxk</label>
      <label><input type="checkbox" data-player="haxo" checked><img src="it.png" alt="">Haxo</label>
      <label><input type="checkbox" data-player="shin" checked><img src="fr.png" alt="">Shin</label>
      <label><input type="checkbox" data-player="yayaz" checked><img src="fr.png" alt="">Yayaz</label>
      <label><input type="checkbox" data-player="nerzox" checked><img src="fr.png" alt="">Nerzox</label>
    </div>
  </header>

  <div class="pov-container">
    <div class="pov" id="pov-erxk" data-player="erxk">
      <div class="info-bar"><img src="hu.png" alt="">Erxk</div>
      <button class="focus-btn" data-focus="erxk">ðŸŽ¯</button>
    </div>
    <div class="pov" id="pov-haxo" data-player="haxo">
      <div class="info-bar"><img src="it.png" alt="">Haxo</div>
      <button class="focus-btn" data-focus="haxo">ðŸŽ¯</button>
    </div>
    <div class="pov" id="pov-shin" data-player="shin">
      <div class="info-bar"><img src="fr.png" alt="">Shin</div>
      <button class="focus-btn" data-focus="shin">ðŸŽ¯</button>
    </div>
    <div class="pov" id="pov-yayaz" data-player="yayaz">
      <div class="info-bar"><img src="fr.png" alt="">Yayaz</div>
      <button class="focus-btn" data-focus="yayaz">ðŸŽ¯</button>
    </div>
    <div class="pov" id="pov-nerzox" data-player="nerzox">
      <div class="info-bar"><img src="fr.png" alt="">Nerzox</div>
      <button class="focus-btn" data-focus="nerzox">ðŸŽ¯</button>
    </div>
  </div>

  <script>
    const players = {
      erxk: { channel: "erxk0" },
      haxo: { channel: "haxofnbr" },
      shin: { channel: "12shinn" },
      yayaz: { channel: "yayaz_fn" },
      nerzox: { channel: "nerzox35" },
    };

    const twitchPlayers = {};

    // CrÃ©e les embeds Twitch
    for (const id in players) {
      twitchPlayers[id] = new Twitch.Player(`pov-${id}`, {
        channel: players[id].channel,
        width: "100%",
        height: "100%",
        muted: true,
      });
    }

    // GÃ©rer le focus
    let focused = null;
    document.querySelectorAll(".focus-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const playerId = btn.dataset.focus;
        const pov = document.getElementById(`pov-${playerId}`);

        document.querySelectorAll(".pov").forEach(p => p.classList.remove("focus"));
        for (const id in twitchPlayers) twitchPlayers[id].setMuted(true);

        if (focused === playerId) {
          focused = null;
        } else {
          pov.classList.add("focus");
          twitchPlayers[playerId].setMuted(false);
          focused = playerId;
        }
      });
    });

    // Affichage / Masquage des POV
    document.querySelectorAll(".player-selection input").forEach(cb => {
      cb.addEventListener("change", () => {
        const pov = document.querySelector(`#pov-${cb.dataset.player}`);
        pov.hidden = !cb.checked;
        updateGridLayout();
      });
    });

    // Met Ã  jour la grille selon le nombre visible
    function updateGridLayout() {
      const povContainer = document.querySelector(".pov-container");
      const visiblePOVs = document.querySelectorAll(".pov:not([hidden])").length;
      povContainer.dataset.count = visiblePOVs;
    }

    updateGridLayout();
  </script>
</body>
</html>
