<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kataktis POV Manager</title>
<link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
<style>
  * { box-sizing: border-box; transition: all 0.25s ease; }
  html, body { margin:0; height:100%; font-family: 'Rajdhani', sans-serif; background:#0a0a0a; color:white; display:flex; flex-direction:column;}
  header {
    position: fixed; top:0; width:100%; display:flex; align-items:center; justify-content:space-between;
    padding:10px 30px; background: rgba(10,10,10,0.85); border-bottom:2px solid #e50914;
    box-shadow:0 0 15px rgba(229,9,20,0.4); z-index:100; backdrop-filter: blur(10px);
  }
  header img{height:50px;}
  header h1{margin:0;font-size:22px;text-transform:uppercase;letter-spacing:2px;}
  .player-selection{
    position: fixed; top:70px; width:100%; display:flex; justify-content:center; flex-wrap:wrap;
    background: rgba(20,20,20,0.85); border-bottom:1px solid #e50914; padding:8px; z-index:99;
  }
  .player-selection label{margin:5px 12px; display:flex; align-items:center; gap:6px; cursor:pointer; font-weight:bold; font-size:15px;}
  .player-selection img{height:16px; border-radius:2px;}
  input[type="checkbox"]{accent-color:#e50914; cursor:pointer;}
  .main{flex:1; display:grid; grid-template-columns: repeat(auto-fit,minmax(0,1fr)); grid-auto-rows:1fr; gap:15px; padding:160px 20px 20px;}
  .pov{
    position:relative; width:100%; height:100%; background:rgba(20,20,20,0.85);
    border:2px solid rgba(229,9,20,0.5); box-shadow:0 0 20px rgba(229,9,20,0.2); border-radius:12px; overflow:hidden; display:flex; flex-direction:column;
  }
  .info-bar{
    position:absolute; bottom:8px; left:8px; background:rgba(0,0,0,0.7); padding:4px 8px; border-radius:8px; display:flex; align-items:center; gap:6px; font-size:14px;
  }
  .info-bar img{height:16px;border-radius:2px;}
  .focus-btn,.hide-btn{
    background-color:#e50914;border:none;color:white;font-size:12px;padding:2px 6px;border-radius:5px;cursor:pointer;
  }
  .focus-btn:hover,.hide-btn:hover{background-color:#ff1a1a;}
  .hide-btn{background-color:#333;margin-left:5px;}
  .focused{position:fixed !important;top:0;left:0;width:100vw !important;height:100vh !important;z-index:200;border:3px solid #ff0000;box-shadow:0 0 40px #ff0000;background-color:black;}
  .hidden{display:none !important;}
  footer{flex-shrink:0; text-align:center; padding:12px; font-size:13px; background:#111; border-top:2px solid #e50914;}
</style>
</head>
<body>
<header>
  <img src="logo.png" alt="Logo Team">
  <h1>Kataktis POV Manager</h1>
</header>

<div class="player-selection">
  <label><input type="checkbox" data-player="erxk" checked><img src="hu.png" alt="üá≠üá∫">Erxk</label>
  <label><input type="checkbox" data-player="haxo" checked><img src="it.png" alt="üáÆüáπ">Haxo</label>
  <label><input type="checkbox" data-player="shin" checked><img src="fr.png" alt="üá´üá∑">Shin</label>
  <label><input type="checkbox" data-player="yayaz" checked><img src="fr.png" alt="üá´üá∑">Yayaz</label>
  <label><input type="checkbox" data-player="nerzox" checked><img src="fr.png" alt="üá´üá∑">Nerzox</label>
</div>

<div class="main">
  <div class="pov" data-player="erxk"><div id="twitch-erxk" style="width:100%;height:100%;"></div>
    <div class="info-bar"><img src="hu.png"><span>Erxk</span>
      <button class="focus-btn" data-focus="erxk">üéØ</button>
      <button class="hide-btn" data-hide="erxk">‚ùå</button>
    </div>
  </div>
  <div class="pov" data-player="haxo"><div id="twitch-haxo" style="width:100%;height:100%;"></div>
    <div class="info-bar"><img src="it.png"><span>Haxo</span>
      <button class="focus-btn" data-focus="haxo">üéØ</button>
      <button class="hide-btn" data-hide="haxo">‚ùå</button>
    </div>
  </div>
  <div class="pov" data-player="shin"><div id="twitch-shin" style="width:100%;height:100%;"></div>
    <div class="info-bar"><img src="fr.png"><span>Shin</span>
      <button class="focus-btn" data-focus="shin">üéØ</button>
      <button class="hide-btn" data-hide="shin">‚ùå</button>
    </div>
  </div>
  <div class="pov" data-player="yayaz"><div id="twitch-yayaz" style="width:100%;height:100%;"></div>
    <div class="info-bar"><img src="fr.png"><span>Yayaz</span>
      <button class="focus-btn" data-focus="yayaz">üéØ</button>
      <button class="hide-btn" data-hide="yayaz">‚ùå</button>
    </div>
  </div>
  <div class="pov" data-player="nerzox"><div id="twitch-nerzox" style="width:100%;height:100%;"></div>
    <div class="info-bar"><img src="fr.png"><span>Nerzox</span>
      <button class="focus-btn" data-focus="nerzox">üéØ</button>
      <button class="hide-btn" data-hide="nerzox">‚ùå</button>
    </div>
  </div>
</div>

<footer>Kataktis eSport - Interface Staff POV</footer>

<script src="https://embed.twitch.tv/embed/v1.js"></script>
<script>
  const players = [
    {id:'erxk', channel:'erxk0'},
    {id:'haxo', channel:'haxofnbr'},
    {id:'shin', channel:'12shinn'},
    {id:'yayaz', channel:'yayaz_fn'},
    {id:'nerzox', channel:'nerzox35'}
  ];
  const povs = document.querySelectorAll('.pov');
  const checkboxes = document.querySelectorAll('.player-selection input');
  const focusButtons = document.querySelectorAll('[data-focus]');
  const hideButtons = document.querySelectorAll('[data-hide]');
  let focusedIndex=-1;
  const povArray=Array.from(povs);
  const twitchEmbeds = {};

  // Cr√©ation des Twitch Embed
  players.forEach(p=>{
    const embed = new Twitch.Embed('twitch-'+p.id,{
      width:'100%',
      height:'100%',
      channel:p.channel,
      parent:['kataktis.github.io'],
      muted:true
    });
    embed.addEventListener(Twitch.Embed.VIDEO_READY, ()=>{
      twitchEmbeds[p.id]=embed.getPlayer();
    });
  });

  function resizePOVs(){
    const visiblePOVs=document.querySelectorAll('.pov:not(.hidden)');
    const grid=document.querySelector('.main');
    if(visiblePOVs.length===1) grid.style.gridTemplateColumns='1fr';
    else if(visiblePOVs.length===2) grid.style.gridTemplateColumns='1fr 1fr';
    else if(visiblePOVs.length<=4) grid.style.gridTemplateColumns='repeat(2,1fr)';
    else grid.style.gridTemplateColumns='repeat(auto-fit,minmax(0,1fr))';
  }

  // Focus
  focusButtons.forEach(btn=>{
    btn.addEventListener('click',()=>{
      const player=btn.getAttribute('data-focus');
      const pov=document.querySelector(`.pov[data-player="${player}"]`);
      if(pov.classList.contains('focused')){
        pov.classList.remove('focused');
        focusedIndex=-1;
        muteAllPOVs(true);
      }else{
        povs.forEach(p=>p.classList.remove('focused'));
        pov.classList.add('focused');
        focusedIndex=povArray.indexOf(pov);
        muteAllPOVs(true);
        unmutePOV(player);
      }
    });
  });

  hideButtons.forEach(btn=>{
    btn.addEventListener('click',()=>{
      const player=btn.getAttribute('data-hide');
      const pov=document.querySelector(`.pov[data-player="${player}"]`);
      pov.classList.add('hidden');
      document.querySelector(`.player-selection input[data-player="${player}"]`).checked=false;
      resizePOVs();
    });
  });

  checkboxes.forEach(cb=>{
    cb.addEventListener('change',()=>{
      const player=cb.getAttribute('data-player');
      const pov=document.querySelector(`.pov[data-player="${player}"]`);
      cb.checked ? pov.classList.remove('hidden') : pov.classList.add('hidden');
      resizePOVs();
    });
  });

  // Navigation clavier
  document.addEventListener('keydown',e=>{
    if(focusedIndex===-1)return;
    if(e.key==='ArrowRight') changeFocus(1);
    else if(e.key==='ArrowLeft') changeFocus(-1);
    else if(e.key==='Escape'){
      povArray[focusedIndex].classList.remove('focused');
      focusedIndex=-1;
      muteAllPOVs(true);
    }
  });

  function changeFocus(dir){
    povArray[focusedIndex].classList.remove('focused');
    focusedIndex=(focusedIndex+dir+povArray.length)%povArray.length;
    povArray[focusedIndex].classList.add('focused');
    muteAllPOVs(true);
    const player=povArray[focusedIndex].getAttribute('data-player');
    unmutePOV(player);
  }

  function muteAllPOVs(mute=true){
    players.forEach(p=>{
      if(twitchEmbeds[p.id]){
        twitchEmbeds[p.id].setMuted(mute);
      }
    });
  }

  function unmutePOV(player){
    if(twitchEmbeds[player]) twitchEmbeds[player].setMuted(false);
  }

  window.addEventListener('resize',resizePOVs);
  resizePOVs();
</script>
</body>
</html>
