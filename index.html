<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kataktis POV Viewer</title>
  <style>
    body {
      margin: 0;
      background-color: #0b0b0b;
      color: white;
      font-family: Arial, sans-serif;
    }

    header {
      background-color: #b30000;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 20px;
    }

    header img.logo {
      height: 40px;
    }

    .player-selection {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .player-selection label {
      display: flex;
      align-items: center;
      background-color: #1a1a1a;
      padding: 6px 10px;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.2s;
    }

    .player-selection label:hover {
      background-color: #292929;
    }

    .player-selection input {
      margin-right: 6px;
    }

    .player-selection img {
      height: 16px;
      width: auto;
      margin-right: 6px;
      border-radius: 3px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 10px;
      padding: 10px;
      transition: 0.3s;
    }

    .pov {
      position: relative;
      background-color: #000;
      border-radius: 10px;
      overflow: hidden;
      aspect-ratio: 16 / 9;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .pov iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    .pov-info {
      position: absolute;
      top: 8px;
      left: 8px;
      background: rgba(0, 0, 0, 0.6);
      padding: 4px 8px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
    }

    .pov-info img {
      height: 14px;
      width: auto;
      border-radius: 2px;
    }

    .focus-btn {
      position: absolute;
      bottom: 8px;
      right: 8px;
      background: rgba(179, 0, 0, 0.8);
      border: none;
      color: white;
      padding: 6px 10px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      transition: 0.2s;
    }

    .focus-btn:hover {
      background: rgba(255, 0, 0, 0.9);
    }

    .focused {
      position: fixed !important;
      top: 0;
      left: 0;
      width: 100vw !important;
      height: 100vh !important;
      z-index: 1000;
      border-radius: 0;
    }

    .focused .focus-btn {
      bottom: 20px;
      right: 20px;
      background: rgba(255, 0, 0, 0.9);
    }
  </style>
</head>
<body>
  <header>
    <img src="logo.png" class="logo" alt="Team Logo">
    <div class="player-selection">
      <label><input type="checkbox" data-player="domingo" checked><img src="fr.png"> Domingo</label>
      <label><input type="checkbox" data-player="terracid" checked><img src="fr.png"> Terracid</label>
      <label><input type="checkbox" data-player="sardoche" checked><img src="fr.png"> Sardoche</label>
      <label><input type="checkbox" data-player="siphano" checked><img src="fr.png"> Siphano</label>
      <label><input type="checkbox" data-player="gotaga" checked><img src="fr.png"> Gotaga</label>
    </div>
  </header>

  <div class="grid" id="grid"></div>

  <script src="https://player.twitch.tv/js/embed/v1.js"></script>
  <script>
    const players = {
      domingo: { name: "Domingo", country: "fr.png", channel: "domingo" },
      terracid: { name: "Terracid", country: "fr.png", channel: "terracid" },
      sardoche: { name: "Sardoche", country: "fr.png", channel: "sardoche" },
      siphano: { name: "Siphano", country: "fr.png", channel: "siphano" },
      gotaga: { name: "Gotaga", country: "fr.png", channel: "gotaga" },
    };

    const grid = document.getElementById("grid");

    function renderPlayers() {
      grid.innerHTML = "";
      const checked = [...document.querySelectorAll(".player-selection input:checked")].map(i => i.dataset.player);
      checked.forEach(key => {
        const p = players[key];
        const pov = document.createElement("div");
        pov.className = "pov";
        pov.innerHTML = `
          <div class="pov-info">
            <img src="${p.country}">
            <span>${p.name}</span>
          </div>
          <div id="twitch-${key}"></div>
          <button class="focus-btn">Focus</button>
        `;
        grid.appendChild(pov);

        const player = new Twitch.Player(`twitch-${key}`, {
          channel: p.channel,
          width: "100%",
          height: "100%",
          parent: [window.location.hostname]
        });

        const btn = pov.querySelector(".focus-btn");
        btn.addEventListener("click", () => {
          if (pov.classList.contains("focused")) {
            pov.classList.remove("focused");
            document.querySelectorAll(".pov iframe").forEach(f => f.contentWindow.postMessage({ event: "command", func: "mute" }, "*"));
          } else {
            document.querySelectorAll(".pov").forEach(el => el.classList.remove("focused"));
            pov.classList.add("focused");
          }
        });
      });
    }

    document.querySelectorAll(".player-selection input").forEach(i => i.addEventListener("change", renderPlayers));
    renderPlayers();
  </script>
</body>
</html>
