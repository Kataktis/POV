<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kataktis POV Manager</title>
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&display=swap" rel="stylesheet" />
  <script src="https://player.twitch.tv/js/embed/v1.js"></script>
  <style>
    * {
      box-sizing: border-box;
      font-family: "Rajdhani", sans-serif;
    }

    body {
      margin: 0;
      background: radial-gradient(circle at top, #200000, #000);
      color: white;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 20px;
      background: rgba(255, 0, 0, 0.15);
      border-bottom: 2px solid red;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo img {
      height: 40px;
    }

    .player-selection {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
    }

    .player-selection label {
      display: flex;
      align-items: center;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 0, 0, 0.5);
      border-radius: 8px;
      padding: 5px 10px;
      cursor: pointer;
      transition: 0.2s;
    }

    .player-selection label:hover {
      background: rgba(255, 0, 0, 0.3);
    }

    .player-selection img {
      height: 16px;
      width: auto;
      margin-right: 6px;
      border-radius: 2px;
    }

    .pov-grid {
      display: grid;
      gap: 10px;
      padding: 10px;
      width: 100%;
      height: 100%;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      grid-auto-rows: 1fr;
      transition: all 0.3s ease;
    }

    .pov {
      position: relative;
      background: #000;
      border-radius: 10px;
      overflow: hidden;
      aspect-ratio: 16 / 9;
      display: flex;
      flex-direction: column;
      transition: all 0.3s ease;
    }

    .pov.focused {
      grid-column: 1 / -1;
      grid-row: 1 / -1;
      z-index: 10;
      aspect-ratio: auto;
      height: calc(100vh - 140px);
    }

    .pov iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    .info-bar {
      position: absolute;
      top: 6px;
      left: 6px;
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(0, 0, 0, 0.65);
      padding: 4px 8px;
      border-radius: 8px;
      color: #fff;
      font-size: 14px;
    }

    .info-bar img {
      height: 16px;
      border-radius: 2px;
    }

    .focus-btn, .hide-btn {
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: #fff;
      cursor: pointer;
      padding: 2px 6px;
      border-radius: 4px;
      transition: 0.2s;
    }

    .focus-btn:hover {
      background: rgba(255, 0, 0, 0.7);
    }

    .hide-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <img src="logo.png" alt="Logo Team">
      <h1>KATAKTIS STAFF VIEW</h1>
    </div>
    <div class="player-selection">
      <label><input type="checkbox" data-player="erxk" checked><img src="hu.png" alt="üá≠üá∫">Erxk</label>
      <label><input type="checkbox" data-player="haxo" checked><img src="it.png" alt="üáÆüáπ">Haxo</label>
      <label><input type="checkbox" data-player="shin" checked><img src="fr.png" alt="üá´üá∑">Shin</label>
      <label><input type="checkbox" data-player="yayaz" checked><img src="fr.png" alt="üá´üá∑">Yayaz</label>
      <label><input type="checkbox" data-player="nerzox" checked><img src="fr.png" alt="üá´üá∑">Nerzox</label>
    </div>
  </header>

  <div class="pov-grid" id="povGrid"></div>

  <script>
    const playersData = {
      erxk: { channel: "erxk0", name: "Erxk", flag: "hu.png" },
      haxo: { channel: "haxofnbr", name: "Haxo", flag: "it.png" },
      shin: { channel: "12shinn", name: "Shin", flag: "fr.png" },
      yayaz: { channel: "yayaz_fn", name: "Yayaz", flag: "fr.png" },
      nerzox: { channel: "nerzox35", name: "Nerzox", flag: "fr.png" },
    };

    const povGrid = document.getElementById("povGrid");
    const players = {};
    let focused = null;

    function createPOV(id) {
      const data = playersData[id];
      const pov = document.createElement("div");
      pov.className = "pov";
      pov.dataset.player = id;

      const infoBar = document.createElement("div");
      infoBar.className = "info-bar";
      infoBar.innerHTML = `
        <img src="${data.flag}" alt="">
        <span>${data.name}</span>
        <button class="focus-btn" data-focus="${id}">üéØ</button>
        <button class="hide-btn" data-hide="${id}">‚ùå</button>
      `;
      pov.appendChild(infoBar);

      const iframeDiv = document.createElement("div");
      iframeDiv.id = `player-${id}`;
      pov.appendChild(iframeDiv);
      povGrid.appendChild(pov);

      players[id] = new Twitch.Player(`player-${id}`, {
        channel: data.channel,
        width: "100%",
        height: "100%",
        muted: true,
      });
    }

    function refreshGrid() {
      povGrid.innerHTML = "";
      for (const id in playersData) {
        const checkbox = document.querySelector(`[data-player="${id}"]`);
        if (checkbox.checked) createPOV(id);
      }
      setupButtons();
    }

    function setupButtons() {
      document.querySelectorAll(".focus-btn").forEach(btn => {
        btn.onclick = () => focusPOV(btn.dataset.focus);
      });
      document.querySelectorAll(".hide-btn").forEach(btn => {
        btn.onclick = () => {
          document.querySelector(`[data-player="${btn.dataset.hide}"]`).checked = false;
          refreshGrid();
        };
      });
    }

    function focusPOV(id) {
      const povs = document.querySelectorAll(".pov");
      povs.forEach(pov => pov.classList.remove("focused"));
      const pov = document.querySelector(`.pov[data-player="${id}"]`);
      pov.classList.add("focused");
      focused = id;

      for (const p in players) players[p].setMuted(true);
      players[id].setMuted(false);
    }

    document.querySelectorAll('.player-selection input').forEach(input => {
      input.addEventListener('change', refreshGrid);
    });

    refreshGrid();
  </script>
</body>
</html>
